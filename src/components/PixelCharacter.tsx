import type { CharacterCustomization } from "@/types";

interface PixelCharacterProps {
  classId: string;
  customization: CharacterCustomization;
  color: string;
  size?: number;
}

// 16x16 pixel grid definitions - each array is a row, numbers map to colors
// 0 = transparent, 1 = skin, 2 = primary color, 3 = secondary/dark, 4 = accent, 5 = hair color, 6 = white, 7 = black

const baseTemplates: Record<string, number[][]> = {
  claude: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,2,2,2,2,2,2,0,0,0,0,0],
    [0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0],
    [0,0,0,1,1,7,1,1,1,1,7,1,1,0,0,0],
    [0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0],
    [0,0,0,1,1,1,1,3,3,1,1,1,1,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0],
    [0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0],
    [0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0],
    [0,0,0,2,2,2,2,2,2,2,2,2,2,0,0,0],
    [0,0,0,2,2,1,2,2,2,2,1,2,2,0,0,0],
    [0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],
    [0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0],
  ],
  wizard: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,2,2,2,2,2,2,0,0,0,0,0],
    [0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0],
    [0,0,0,1,1,7,1,1,1,1,7,1,1,0,0,0],
    [0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0],
    [0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0],
    [0,0,0,0,1,5,5,5,5,5,5,1,0,0,0,0],
    [0,0,0,0,0,5,5,5,5,5,5,0,0,0,0,0],
    [0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0],
    [0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0],
    [0,0,0,2,2,2,2,2,2,2,2,2,2,0,0,0],
    [0,0,2,2,2,1,2,2,2,2,1,2,2,2,0,0],
    [0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],
    [0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0],
  ],
  knight: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,0],
    [0,0,0,0,3,3,3,3,3,3,3,3,0,0,0,0],
    [0,0,0,0,3,3,3,3,3,3,3,3,0,0,0,0],
    [0,0,0,3,3,7,3,3,3,3,7,3,3,0,0,0],
    [0,0,0,3,3,3,3,3,3,3,3,3,3,0,0,0],
    [0,0,0,3,3,3,3,1,1,3,3,3,3,0,0,0],
    [0,0,0,0,3,3,3,3,3,3,3,3,0,0,0,0],
    [0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,0],
    [0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,0,3,3,3,3,3,3,3,3,0,0,0,0],
    [0,0,0,3,3,3,3,3,3,3,3,3,3,0,0,0],
    [0,0,0,3,3,3,3,3,3,3,3,3,3,0,0,0],
    [0,0,0,0,0,3,0,0,0,0,3,0,0,0,0,0],
    [0,0,0,0,3,3,0,0,0,0,3,3,0,0,0,0],
  ],
  rogue: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,5,5,5,5,5,5,0,0,0,0,0],
    [0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0],
    [0,0,0,1,1,7,1,1,1,1,7,1,1,0,0,0],
    [0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0],
    [0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0],
    [0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0],
    [0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0],
    [0,0,0,0,3,3,3,3,3,3,3,3,0,0,0,0],
    [0,0,0,3,3,3,3,3,3,3,3,3,3,0,0,0],
    [0,0,0,3,3,1,3,3,3,3,1,3,3,0,0,0],
    [0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],
    [0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0],
  ],
};

const hatTemplates: Record<string, number[][]> = {
  cap: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0],
    [0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0],
    [0,0,0,2,2,2,2,2,2,2,2,2,2,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  ],
  wizard: [
    [0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0],
    [0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,0],
    [0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0],
    [0,0,0,2,2,2,2,2,2,2,2,2,0,0,0,0],
  ],
  crown: [
    [0,0,0,0,4,0,4,0,4,0,4,0,0,0,0,0],
    [0,0,0,0,4,4,4,4,4,4,4,0,0,0,0,0],
    [0,0,0,0,4,4,4,4,4,4,4,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  ],
  hood: [
    [0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,0],
    [0,0,0,0,3,3,3,3,3,3,3,3,0,0,0,0],
    [0,0,0,3,3,3,3,3,3,3,3,3,3,0,0,0],
    [0,0,0,3,3,0,0,0,0,0,0,3,3,0,0,0],
    [0,0,0,3,0,0,0,0,0,0,0,0,3,0,0,0],
  ],
};

const hairTemplates: Record<string, number[][]> = {
  short: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,5,5,5,5,5,5,0,0,0,0,0],
    [0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0],
    [0,0,0,0,5,0,0,0,0,0,0,5,0,0,0,0],
  ],
  long: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0],
    [0,0,0,5,5,5,5,5,5,5,5,5,5,0,0,0],
    [0,0,0,5,5,0,0,0,0,0,0,5,5,0,0,0],
    [0,0,0,5,0,0,0,0,0,0,0,0,5,0,0,0],
    [0,0,0,5,0,0,0,0,0,0,0,0,5,0,0,0],
    [0,0,0,5,0,0,0,0,0,0,0,0,5,0,0,0],
    [0,0,0,5,0,0,0,0,0,0,0,0,5,0,0,0],
    [0,0,0,5,0,0,0,0,0,0,0,0,5,0,0,0],
    [0,0,0,5,5,0,0,0,0,0,0,5,5,0,0,0],
    [0,0,0,0,5,5,0,0,0,0,5,5,0,0,0,0],
  ],
  spiky: [
    [0,0,0,0,5,0,0,5,5,0,0,5,0,0,0,0],
    [0,0,0,0,5,5,0,5,5,0,5,5,0,0,0,0],
    [0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0],
    [0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0],
    [0,0,0,0,5,0,0,0,0,0,0,5,0,0,0,0],
  ],
  curly: [
    [0,0,0,0,0,5,0,5,5,0,5,0,0,0,0,0],
    [0,0,0,0,5,0,5,5,5,5,0,5,0,0,0,0],
    [0,0,0,5,5,5,5,5,5,5,5,5,5,0,0,0],
    [0,0,0,5,5,5,5,5,5,5,5,5,5,0,0,0],
    [0,0,0,5,5,0,0,0,0,0,0,5,5,0,0,0],
  ],
};

const beardTemplates: Record<string, number[][]> = {
  stubble: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,5,0,5,0,0,5,0,5,0,0,0,0],
    [0,0,0,0,0,5,0,5,5,0,5,0,0,0,0,0],
    [0,0,0,0,0,0,5,0,0,5,0,0,0,0,0,0],
  ],
  short: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,5,5,0,0,0,0,5,5,0,0,0,0],
    [0,0,0,0,0,5,5,5,5,5,5,0,0,0,0,0],
    [0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,5,5,0,0,0,0,0,0,0],
  ],
  long: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,5,5,5,0,0,0,0,5,5,5,0,0,0],
    [0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0],
    [0,0,0,0,0,5,5,5,5,5,5,0,0,0,0,0],
    [0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0],
    [0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,5,5,0,0,0,0,0,0,0],
  ],
  wizard: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,5,5,5,0,0,0,0,5,5,5,0,0,0],
    [0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0],
    [0,0,0,0,0,5,5,5,5,5,5,0,0,0,0,0],
    [0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0],
    [0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0],
    [0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,5,5,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,5,5,0,0,0,0,0,0,0],
  ],
};

const topTemplates: Record<string, number[][]> = {
  shirt: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0],
    [0,0,0,2,2,2,2,2,2,2,2,2,2,0,0,0],
    [0,0,0,2,2,0,2,2,2,2,0,2,2,0,0,0],
  ],
  armor: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,3,3,3,3,3,3,3,3,3,3,0,0,0],
    [0,0,3,3,3,3,3,4,3,3,3,3,3,3,0,0],
    [0,0,3,3,3,0,3,3,3,3,0,3,3,3,0,0],
  ],
  robe: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,2,2,2,2,2,2,2,2,2,2,0,0,0],
    [0,0,2,2,2,2,2,4,2,2,2,2,2,2,0,0],
    [0,2,2,2,2,0,2,4,2,2,0,2,2,2,2,0],
    [0,2,0,0,0,0,2,4,2,0,0,0,0,0,2,0],
    [0,2,0,0,0,0,2,2,2,0,0,0,0,0,2,0],
  ],
  cloak: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,3,0,0,0,0,0,0,0,0,0,0,3,0,0],
    [0,0,3,3,0,0,0,0,0,0,0,0,3,3,0,0],
    [0,0,3,3,0,0,0,0,0,0,0,0,3,3,0,0],
    [0,0,3,3,0,0,0,0,0,0,0,0,3,3,0,0],
    [0,0,3,3,0,0,0,0,0,0,0,0,3,3,0,0],
    [0,0,3,3,0,0,0,0,0,0,0,0,3,3,0,0],
    [0,0,3,3,0,0,0,0,0,0,0,0,3,3,0,0],
    [0,0,3,3,3,0,0,0,0,0,0,3,3,3,0,0],
    [0,0,0,3,3,3,0,0,0,0,3,3,3,0,0,0],
    [0,0,0,0,3,3,3,0,0,3,3,3,0,0,0,0],
    [0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,0],
  ],
};

const accessoryTemplates: Record<string, number[][]> = {
  glasses: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,7,7,7,7,0,0,7,7,7,7,0,0,0],
    [0,0,0,7,6,6,7,7,7,7,6,6,7,0,0,0],
    [0,0,0,7,7,7,7,0,0,7,7,7,7,0,0,0],
  ],
  eyepatch: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,7,7,7,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,7,7,7,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0],
  ],
  scar: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0],
  ],
  earring: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0],
  ],
};

// Equipment templates - items that can be equipped in inventory (reserved for future use)
export const equipmentTemplates: Record<string, number[][]> = {
  // Sword - held in right hand
  sword: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,9,9,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,9,9,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,9,9,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,9,9,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,9,9,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,9,9,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,9,9,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,9,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,10,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  ],
  // Staff - held in left hand
  staff: [
    [0,0,11,11,11,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,11,4,11,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,11,11,11,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  ],
  // Ring - glowing effect on hand
  ring: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,4,11,4,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0],
  ],
  // Book - held/floating
  book: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,10,10,10,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,10,6,10,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,10,6,10,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,10,6,10,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,10,10,10,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  ],
  // Shield - on left arm
  shield: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0],
    [0,9,4,4,9,0,0,0,0,0,0,0,0,0,0,0],
    [0,9,4,4,9,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  ],
  // Potion - at belt
  potion: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,12,12,12,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,12,12,12,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  ],
  // Scroll - at belt
  scroll: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,13,13,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,13,13,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,13,13,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,13,13,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  ],
  // Gem - glowing at chest
  gem: [
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,11,11,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,11,14,14,11,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,11,11,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
  ],
};

function getColorPalette(primaryColor: string): Record<number, string> {
  return {
    0: "transparent",
    1: "#e8beac", // skin
    2: primaryColor, // primary color
    3: "#334155", // dark/secondary
    4: "#fbbf24", // gold accent
    5: "#78716c", // hair/beard color
    6: "#e2e8f0", // white
    7: "#0f172a", // black
    8: "#dc2626", // red (for scar)
    9: "#94a3b8", // silver/steel (for sword, shield)
    10: "#78350f", // brown/wood (for staff, book)
    11: "#a855f7", // magic purple (for staff gem, ring glow)
    12: "#22c55e", // potion green
    13: "#d6d3d1", // scroll tan/parchment
    14: "#06b6d4", // gem cyan
  };
}

export function PixelCharacter({ classId, customization, color, size = 192 }: PixelCharacterProps) {
  const palette = getColorPalette(color);
  const pixelSize = size / 16;

  const renderLayer = (template: number[][] | undefined, keyPrefix = "") => {
    if (!template) return null;

    return template.map((row, y) =>
      row.map((pixel, x) => {
        if (pixel === 0) return null;
        return (
          <rect
            key={`${keyPrefix}${y}-${x}`}
            x={x * pixelSize}
            y={y * pixelSize}
            width={pixelSize}
            height={pixelSize}
            fill={palette[pixel]}
          />
        );
      })
    );
  };

  const idleAnimation = `
    @keyframes idle-bob {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-4px); }
    }
    @keyframes blink {
      0%, 90%, 100% { opacity: 0; }
      92%, 98% { opacity: 1; }
    }
  `;

  const baseTemplate = baseTemplates[classId] || baseTemplates.claude;
  const hatTemplate = customization.hat ? hatTemplates[customization.hat] : undefined;
  const hairTemplate = customization.hair ? hairTemplates[customization.hair] : undefined;
  const beardTemplate = customization.beard ? beardTemplates[customization.beard] : undefined;
  const topTemplate = customization.top ? topTemplates[customization.top] : undefined;
  const accessoryTemplate = customization.accessory ? accessoryTemplates[customization.accessory] : undefined;

  // Eye positions for blinking (in 16x16 grid)
  const leftEyeX = 5;
  const rightEyeX = 10;
  const eyeY = 5;

  return (
    <div style={{ width: size, height: size, overflow: "hidden", paddingTop: 4 }}>
      <style>{idleAnimation}</style>
      <svg
        width={size}
        height={size}
        viewBox={`0 0 ${size} ${size}`}
        style={{
          imageRendering: "pixelated",
          animation: "idle-bob 2.5s steps(2) infinite",
        }}
      >
        {/* Base character */}
        {renderLayer(baseTemplate, "base-")}
        {/* Hair (under hat) */}
        {renderLayer(hairTemplate, "hair-")}
        {/* Top/clothing */}
        {renderLayer(topTemplate, "top-")}
        {/* Beard */}
        {renderLayer(beardTemplate, "beard-")}
        {/* Hat (on top) */}
        {renderLayer(hatTemplate, "hat-")}
        {/* Accessory */}
        {renderLayer(accessoryTemplate, "acc-")}
        {/* Blink overlay */}
        <rect
          x={leftEyeX * pixelSize}
          y={eyeY * pixelSize}
          width={pixelSize}
          height={pixelSize}
          fill={palette[1]}
          style={{ animation: "blink 8s steps(1) infinite" }}
        />
        <rect
          x={rightEyeX * pixelSize}
          y={eyeY * pixelSize}
          width={pixelSize}
          height={pixelSize}
          fill={palette[1]}
          style={{ animation: "blink 8s steps(1) infinite" }}
        />
      </svg>
    </div>
  );
}
